{"version":3,"sources":["../../src/routes/index.js"],"names":[],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;;;AACA,IAAI,SAAS,kBAAQ,MAAR,EAAb;;;AAGA,OAAO,GAAP,CAAW,GAAX,EAAgB,UAAS,GAAT,EAAc,GAAd,EAAmB,IAAnB,EAAyB;AACxC,KAAI,aAAa,KAAG,EAAH,GAAM,EAAN,GAAS,IAA1B;AACA,KAAG,sBAAM,GAAN,CAAU,kBAAV,KAAiC,IAApC,EAAyC;AACxC,MAAI,UAAU;AACV,QAAI,wDADM;AAEV,YAAS;AACR,YAAO,eADC;AAEL,kBAAc;AAFT,IAFC;AAMV,OAAG;AACF,mBAAc,MADZ;AAEF,gBAAW,GAFT;AAGF,cAAS,MAHP;AAIF,UAAK,OAJH;AAKF,UAAK,OALH;AAMF,aAAQ,IANN;AAOF,gBAAW,EAPT;AAQF,iBAAY,CARV;AASF,aAAQ,EATN;AAUF,aAAQ,EAVN;AAWF,aAAQ,EAXN;AAYF,aAAQ,EAZN;AAaF,UAAK,CAbH;AAcF,UAAK;AAdH,IANO;AAsBV,SAAM;AAtBI,GAAd;AAwBA,gCAAG,OAAH,EACK,IADL,CACU,UAAU,IAAV,EAAgB;AACrB,QAAK,OAAL,GAAe,IAAf;;;AAGA,yBAAM,GAAN,CAAU,kBAAV,EAA6B,KAAK,SAAL,CAAe,IAAf,CAA7B,EAAkD,UAAlD;;AAEG,OAAI,MAAJ,CAAW,OAAX,EAAoB,EAAE,MAAM,IAAR,EAApB;AACH,GARL,EASK,KATL,CASW,UAAU,GAAV,EAAe;AAClB,WAAQ,GAAR,CAAY,GAAZ;AACH,GAXL;AAYA,EArCD,MAqCK;;AAEJ,MAAI,OAAO,KAAK,KAAL,CAAW,sBAAM,GAAN,CAAU,kBAAV,CAAX,CAAX;;AAEA,MAAI,MAAJ,CAAW,OAAX,EAAoB,EAAE,MAAM,IAAR,EAApB;AACA;AACD,CA7CD;;AAiDA,OAAO,OAAP,GAAiB,MAAjB","file":"index.js","sourcesContent":["import express from 'express';\nimport rp from 'request-promise';\nimport cache from 'memory-cache';\nvar router = express.Router();\n\n/* GET home page. */\nrouter.get('/', function(req, res, next) {\n\tvar CACHE_TIME = 24*60*60*1000;\n\tif(cache.get('index_movie_list') == null){\n\t\tvar options = {\n\t\t    uri:'https://sp0.baidu.com/8aQDcjqpAAV3otqbppnN2DJv/api.php',\n\t\t    headers: {\n\t\t    \t'Host':'sp0.baidu.com',\n\t\t        'User-Agent': 'Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36'\n\t\t    },\n\t\t    qs:{\n\t\t    \t'resource_id':'6862',\n\t\t    \t'from_mid':'1',\n\t\t    \t'format':'json',\n\t\t    \t'ie':'utf-8',\n\t\t    \t'oe':'utf-8',\n\t\t    \t'query':'电影',\n\t\t    \t'sort_key':16,\n\t\t    \t'sort_type':1,\n\t\t    \t'stat0':'',\n\t\t    \t'stat1':'',\n\t\t    \t'stat2':'',\n\t\t    \t'stat3':'',\n\t\t    \t'pn':0,\n\t\t    \t'rn':48\n\t\t    },\n\t\t    json: true\n\t\t};\n\t\trp(options)\n\t\t    .then(function (data) {\n\t\t    \tdata.isindex = true;\n\n\t\t    \t// 缓存\n\t\t    \tcache.put('index_movie_list',JSON.stringify(data),CACHE_TIME);\n\n\t\t        res.render('index', { data: data });\n\t\t    })\n\t\t    .catch(function (err) {\n\t\t        console.log(err);\n\t\t    });\n\t}else{\n\t\t// 读取缓存\n\t\tvar data = JSON.parse(cache.get('index_movie_list'));\n\t\t\n\t\tres.render('index', { data: data });\n\t}\n});\n\n\n\nmodule.exports = router;\n"]}